---
title: "Geographic Trends Survey Results"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT, 
               ggplot2, 
               maps,
               ggrepel#for better tables
               )

#read in data
geographic_trends_data=read_csv("FinalCleanedData.csv")
```

# Overview {data-orientation=columns}

## Column {data-width=300}

### Questions

The questions that this dashboard will answer are the following: 

* Where are out students going (region)?
* What are the salary differentials by region?
* What types of jobs (By company) are students getting by region?  Are bank and consulting jobs in Chicago and NYC?
* What are the top 3-5 job categories (by company) by city (Chicago, Cincinnati, Columbus, Cleveland)?


## Column {data-width=300}

### Insights

* Accounting and Finance are the top type of jobs in Chicago and NYC. Chicago does have a handful of alumni doing Consulting at West Monroe Partners.
* EY and Deloitte is the in the top 3 companies for Cincinnati, Chicago and Cleveland.
   

# Placement {data-orientation=columns}

## Column {data-width=300}

### Where are students going in the USA?


```{r,echo=FALSE}

# Get a map of the United States
us_map <- map_data("world")

ggplot() +
  geom_polygon(data = us_map, aes(x=long, y = lat, group = group), fill="black", alpha=0.1) +
  geom_path(data = us_map, aes(x = long, y = lat, group = group), color = "gray", size = 0.5) +  # Add state borders
  geom_point(data = geographic_trends_data, aes(x = longitude, y = latitude, alpha = 0.3), color = "blue") +  
  coord_cartesian(xlim = c(-125, -65), ylim = c(24, 49)) 
```

## Column {data-width=300}

### Worldwide

```{r,echo=FALSE}

# Get a map of the United States
us_map <- map_data("world")

ggplot() +
  geom_polygon(data = us_map, aes(x=long, y = lat, group = group), fill="black", alpha=0.1) +
  geom_path(data = us_map, aes(x = long, y = lat, group = group), color = "gray", size = 0.5) +  # Add state borders
  geom_point(data = geographic_trends_data, aes(x = longitude, y = latitude, alpha = 0.3), color = "blue") 
```

# Salary {data-orientation=columns}

### Salary differentials by region

```{r,echo=FALSE}

```


# Company Composition {data-orientation=columns}

```{r, echo=FALSE}
# Create a frequency table of the survey_city column
city_frequency <- table(geographic_trends_data$survey_city)

# Sort the frequency table in descending order
sorted_city_frequency <- sort(city_frequency, decreasing = TRUE)

# Get the top ten most occurring cities
top_ten_cities <- names(sorted_city_frequency[1:10])

#print(top_ten_cities)

```

## column {data-height=600}

### What types of jobs (By company) are students getting by region?  

```{r, echo=FALSE}
data = geographic_trends_data %>%
  group_by(survey_city, survey_company_cluster_name) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name)

datatable(data, rownames=F, extensions = 'Buttons', 
          options = list(dom='Bfrtip',
                         buttons=c('copy','csv','excel')
                         ),
          filter=list(position='bottom',
                      clear=F,plain=T
                      )
          )
```

## column {data-height=600}

### Are bank and consulting jobs in Chicago and NYC?

#### NYC

```{r, echo=FALSE}
geographic_trends_data$survey_city[geographic_trends_data$survey_city=="newyorkcity"] <- "NYC"
data = geographic_trends_data %>%
  filter(survey_city=="NYC" ) %>%
  group_by(survey_city, survey_company_cluster_name, survey_deptfunc) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name, survey_city)

datatable(data, rownames=F, extensions = 'Buttons', 
          options = list(dom='Bfrtip',
                         buttons=c('copy','csv','excel')
                         ),
          filter=list(position='bottom',
                      clear=F,plain=T
                      )
          )
```

#### Chicago
```{r, echo=FALSE}
data = geographic_trends_data %>%
  filter(survey_city=="chicago") %>%
  group_by(survey_city, survey_company_cluster_name, survey_deptfunc) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name, survey_city)

datatable(data, rownames=F, extensions = 'Buttons', 
          options = list(dom='Bfrtip',
                         buttons=c('copy','csv','excel')
                         ),
          filter=list(position='bottom',
                      clear=F,plain=T
                      )
          )
```

# Top 3-5 Companies by City {data-orientation=columns}

What are the top 3-5 job categories (by company) by city (Chicago, Cincinnati, Cleveland, Columbus)?

## row {data-height=600}

### Chicago

```{r, echo=FALSE}
data = geographic_trends_data %>%
  filter(survey_city=="chicago") %>%
  group_by(survey_city, survey_company_cluster_name) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name) %>%
  slice_head(n = 5)

datatable(data, rownames=F, extensions = 'Buttons')
```

### Cleveland

```{r, echo=FALSE}
data = geographic_trends_data %>%
  filter(survey_city=="cleveland") %>%
  group_by(survey_city, survey_company_cluster_name) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name) %>%
  slice_head(n = 5)

datatable(data, rownames=F, extensions = 'Buttons')
```


## row {data-height=600}


### Cincinnati

```{r, echo=FALSE}
data = geographic_trends_data %>%
  filter(survey_city=="cincinnati") %>%
  group_by(survey_city, survey_company_cluster_name) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name) %>%
  slice_head(n = 5)

datatable(data, rownames=F, extensions = 'Buttons')
```


### Columbus

```{r, echo=FALSE}
data = geographic_trends_data %>%
  filter(survey_city=="columbus") %>%
  group_by(survey_city, survey_company_cluster_name) %>%
  summarize(count=n()) %>%
  arrange(-count, survey_company_cluster_name) %>%
  slice_head(n = 5)

datatable(data, rownames=F, extensions = 'Buttons')
```
